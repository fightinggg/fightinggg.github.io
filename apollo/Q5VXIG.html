<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> LDA · Believe it</title><meta name="description" content="LDA - fightinggg"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/apollo/favicon.png"><link rel="stylesheet" href="/apollo/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://fightinggg.github.io/apollo/atom.xml" title="Believe it"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/apollo/atom.xml" title="Believe it" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/apollo/" class="logo-link"><img src="/apollo/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/apollo/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/apollo/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/apollo/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">LDA</h1><div class="post-info">2020年2月18日</div><div class="post-content"><div><a href="/next/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">next</a><a href="/hexonext/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">hexonext</a><a href="/butterfly/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">butterfly</a><a href="/volantis/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">volantis</a><a href="/yearn/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yearn</a><a href="/yilia/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yilia</a><a href="/shoka/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">shoka</a><a href="/indigo/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">indigo</a><a href="/apollo/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">apollo</a><a href="/landscape/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">landscape</a><a href="/cactus/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">cactus</a><a href="/matery/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">matery</a><a href="/icarus/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">icarus</a><a href="/fluid/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">fluid</a><a href="/material/Q5VXIG.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">material</a><div style="clear: both;"></div></div>

<h1 id="LDA"><a href="#LDA" class="headerlink" title="LDA"></a>LDA</h1><h2 id="算法输入与目的"><a href="#算法输入与目的" class="headerlink" title="算法输入与目的"></a>算法输入与目的</h2><p>有很多有标签的高纬数据,他们的格式为列向量：</p>
<p>$$<br>x &#x3D; [x_1,x_2,x_3…]^T<br>$$</p>
<p>我们想要找到一个高纬空间到一维空间的映射,其中$w$是一个列向量</p>
<p>$$<br>y&#x3D;w^T x<br>$$</p>
<p>使得我们在这个新的维度上，能够完成分类，类内紧凑，类间松散</p>
<!---more-->

<h2 id="模型建立"><a href="#模型建立" class="headerlink" title="模型建立"></a>模型建立</h2><p>假设映射后类别i的数据集合为：</p>
<p>$$<br>Y_i &#x3D; {y_1,y_2,y_3…}<br>$$</p>
<p>分别根据求映射后数据集合的期望</p>
<p>$$<br>\tilde{m_i}&#x3D;\frac{1}{n_i}\sum_{y\in Y_i}y<br>$$</p>
<p>和方差</p>
<p>$$<br>\tilde{S_i}^2 &#x3D; \sum_{y \in Y_i}(y-\tilde{m_i})^2<br>$$</p>
<p>模型建立,把类中心点间的方差作为分子，把类内方差和作为分母，我们的目标就是最大化整个分式</p>
<p>$$<br>\tilde{m}&#x3D;\frac{1}{n}\sum n_i*\tilde{m_i}<br>\\max\quad J(w)&#x3D;\frac{ \sum n_i(\tilde{m_i}-\tilde{m})^2}{\sum{\tilde{s_i}^2}}<br>$$</p>
<h2 id="变形"><a href="#变形" class="headerlink" title="变形"></a>变形</h2><p>假设映射前类别i的数据集合为：</p>
<p>$$<br>D_i &#x3D; {x_1,x_2,x_3…}<br>$$</p>
<p>为了能够同时描述类内距离和类间距离，我们需要对映射后的各类集合求期望和方差<br>令</p>
<p>$$<br>m_i&#x3D;\frac{1}{n_i}\sum_{x\in D_i}x<br>$$</p>
<p>则映射后的期望为</p>
<p>$$<br>\tilde{m_i}&#x3D;\frac{1}{n_i}\sum_{y\in Y_i}y&#x3D;\frac{1}{n_i}\sum_{x\in D_i}w^Tx&#x3D;w^T\frac{1}{n_i}\sum_{x\in D_i}x&#x3D;w^Tm_i<br>$$</p>
<p>令</p>
<p>$$<br>S_i &#x3D; \sum_{x \in D_i}(x-m_i)(x-m_i)^T<br>$$</p>
<p>则映射后的方差</p>
<p>$$<br>\begin{aligned}<br>\tilde{S_i}^2&amp;&#x3D; \sum_{y \in Y_i}(y-\tilde{m_i})^2<br>\&amp;&#x3D; \sum_{x \in D_i}(w^Tx-w^Tm_i)^2<br>\&amp;&#x3D;\sum_{x \in D_i}(w^T(x-m_i))<em>(w^T(x-m_i))<br>\&amp;&#x3D;\sum_{x \in D_i}(w^T(x-m_i))</em>((x-m_i)^Tw)<br>\&amp;&#x3D;w^TS_iw<br>\end{aligned}<br>$$</p>
<p>模型</p>
<p>$$<br>\tilde{m}&#x3D;\frac{1}{n}\sum n_i<em>\tilde{m_i}&#x3D;w^T\frac{1}{n}\sum n_i</em>m_i&#x3D;w^Tm<br>$$</p>
<p>模型的分子</p>
<p>$$<br>\begin{aligned}<br>\&amp;\sum n_i(\tilde{m_i}-\tilde{m})^2<br>\&#x3D;&amp;\sum n_i(w^Tm_i-w^Tm)^2<br>\&#x3D;&amp;w^T(\sum n_i(m_i-m)(m_i-m)^T) w<br>\end{aligned}<br>$$</p>
<h2 id="模型总结"><a href="#模型总结" class="headerlink" title="模型总结"></a>模型总结</h2><p>$$<br>\begin{aligned}<br>&amp;S_B&#x3D;\sum n_i(m_i-m)(m_i-m)^T<br>\&amp;S_W&#x3D;\sum S_i<br>\&amp;\max\quad J(w)&#x3D;\frac{ w^TS_Bw}{w^TS_ww}<br>\end{aligned}<br>$$</p>
<h2 id="拉格朗日乘子法求极值"><a href="#拉格朗日乘子法求极值" class="headerlink" title="拉格朗日乘子法求极值"></a>拉格朗日乘子法求极值</h2><p>J(w)的值与w的长度无关，只和w的方向有关，我们不妨固定分子为1，则变为了</p>
<p>$$<br>\max\quad J_2(w)&#x3D;w^TS_Bw\quad,\quad w^TS_ww&#x3D;1<br>$$</p>
<p>构建拉格朗日函数,并使用标量对列向量求导法则,求偏导</p>
<p>$$<br>L(w,\lambda) &#x3D; w^TS_Bw+\lambda(1-w^TS_ww)<br>$$</p>
<p>一个求导法则:($x$是列向量，$A$是方阵)</p>
<p>$$<br>\begin{aligned}<br>&amp;\frac{\partial x^TAx}{\partial x} &#x3D; (A^T+A)x<br>\end{aligned}<br>$$</p>
<p>开始求导</p>
<p>$$<br>\begin{aligned}<br>&amp;\frac{\partial L}{\partial w}&#x3D;(S_B+S_B^T)w-\lambda(S_w+S_w^T)w&#x3D;0<br>\end{aligned}<br>$$</p>
<p>其中S_B和S_w是对称矩阵</p>
<p>$$<br>\begin{aligned}<br>&amp;2S_Bw-2\lambda S_ww&#x3D;0<br>\\to&amp;S_Bw&#x3D;\lambda S_ww<br>\\to&amp;(S_w^{-1}S_B)w&#x3D;\lambda w<br>\end{aligned}<br>$$</p>
<p>因此$w$取矩阵$S_w^{-1}S_B$的特征向量即可</p>
</div></article></div></main><footer><div class="paginator"><a href="/apollo/Q5W8L1.html" class="prev">PREV</a><a href="/apollo/Q5TYBT.html" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2023 <a href="http://fightinggg.github.io/apollo">fightinggg</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>