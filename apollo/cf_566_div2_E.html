<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> cf_566_div2_E · Believe it</title><meta name="description" content="cf_566_div2_E - fightinggg"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/apollo/favicon.png"><link rel="stylesheet" href="/apollo/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://fightinggg.github.io/apollo/atom.xml" title="Believe it"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/apollo/atom.xml" title="Believe it" type="application/atom+xml">
</head><body><div class="wrap"><header><a href="/apollo/" class="logo-link"><img src="/apollo/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/apollo/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/apollo/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/apollo/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">cf_566_div2_E</h1><div class="post-info">2019年8月5日</div><div class="post-content"><div><a href="/next/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">next</a><a href="/hexonext/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">hexonext</a><a href="/butterfly/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">butterfly</a><a href="/volantis/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">volantis</a><a href="/yearn/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yearn</a><a href="/yilia/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yilia</a><a href="/shoka/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">shoka</a><a href="/indigo/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">indigo</a><a href="/apollo/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">apollo</a><a href="/landscape/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">landscape</a><a href="/cactus/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">cactus</a><a href="/matery/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">matery</a><a href="/icarus/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">icarus</a><a href="/fluid/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">fluid</a><a href="/material/cf_566_div2_E.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">material</a><div style="clear: both;"></div></div>
转移自<a href='https://fightinggg.github.io/ACM/blog/span/cf_566_div2_E.html'>老blog</a>

<div type="text/javadiv" src="/ACM/js/web_begin.js"></div>
<div>

    <h1><center><a href="https://codeforc.es/contest/1182/problem/E" target="_blank">cf_566_div2_E</a></center></h1>

<span style="float:right">此文更新于2019.6.13</span>
    <div id="text">
            题意：<br>
            &nbsp;&nbsp;&nbsp;&nbsp;f(x)=c^(2x-6)f(x-1)f(x-2)f(x-3)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;输入f(1)&nbsp;f(2)&nbsp;f(3)&nbsp;n&nbsp;c<br>
            &nbsp;&nbsp;&nbsp;&nbsp;输出f(n)<br>
            数据范围：<br>
            &nbsp;&nbsp;&nbsp;&nbsp;f(1)&lt;1e9<br>
            &nbsp;&nbsp;&nbsp;&nbsp;f(2)&lt;1e9<br>
            &nbsp;&nbsp;&nbsp;&nbsp;f(3)&lt;1e9<br>
            &nbsp;&nbsp;&nbsp;&nbsp;c&lt;1e9<br>
            &nbsp;&nbsp;&nbsp;&nbsp;n&lt;1e18<br>
    </div>

    <div type="text/javadiv" src="/ACM/js/solve_begin.js"></div>
    <div>
            法1：<br>
                令g(x)=f(x)*c^x<br>
                则g(x)=g(x-1)g(x-2)g(x-3)<br>
                令h(x)=lg(5,g(x))<br>
                则h(x)=h(x-1)+h(x-2)+g(x-3)<br>
                于是成了bsgs算法+矩阵快速幂<br>
    </div>
    <div type="text/javadiv" src="/ACM/js/solve_end.js"></div>

    <div type="text/javadiv" src="/ACM/js/code_begin.js"></div>
    <div>
            <span style="color:#5a64aa;">#include</span>&lt;<span style="color:#3CBDD0;">bits</span><span style="color:red;">/</span><span style="color:#3CBDD0;">stdc</span><span style="color:red;">+</span><span style="color:red;">+</span><span style="color:#5a64aa;">.h</span>&gt;<br>
            <span style="color:#5a64aa;">using</span>&nbsp;<span style="color:#22CC8D;">namespace</span>&nbsp;<span style="color:#5a64aa;">std; </span><br>
            <br>
            <span style="color:black;">typedef</span>&nbsp;<span style="color:black;">long</span>&nbsp;<span style="color:black;">long</span>&nbsp;<span style="color:#5a64aa;">ll; </span><br>
            <span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">mod</span><span style="color:red;">=</span><span style="color:#22CC8D;">1e9</span><span style="color:red;">+</span><span style="color:#22CC8D;">7; </span><br>
            <br>
            <br>
            <span style="color:black;">struct</span>&nbsp;<span style="color:#3CBDD0;">Sarray</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">static</span>&nbsp;<span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">mod</span><span style="color:red;">=</span><span style="color:#22CC8D;">1e9</span><span style="color:red;">+</span><span style="color:#5a64aa;">6; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">static</span>&nbsp;<span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">LEN</span><span style="color:red;">=</span><span style="color:#5a64aa;">3; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">len,data</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">len,ll</span>&nbsp;<span style="color:#3CBDD0;">flag</span>)<span style="color:#22CC8D;">:len</span>(<span style="color:#3CBDD0;">len</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#5a64aa;">len;i</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#22CC8D;">len;j</span><span style="color:red;">+</span><span style="color:red;">+</span>)<span style="color:#22CC8D;">data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span><span style="color:#5a64aa;">0; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#3CBDD0;">i</span>]<span style="color:red;">=</span><span style="color:#3CBDD0;">flag; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">operator</span>&nbsp;<span style="color:red;">*</span>(<span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:#3CBDD0;">Sarray</span><span style="color:red;">&</span><span style="color:#5a64aa;">a</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">tem</span>(<span style="color:#5a64aa;">a.len,0</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#5a64aa;">len;i</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#22CC8D;">len;j</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">k</span><span style="color:red;">=</span><span style="color:#3CBDD0;">0;k</span>&lt;<span style="color:#3CBDD0;">len;k</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">tem.data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span>(<span style="color:#5a64aa;">tem.data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">+</span><span style="color:#22CC8D;">data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#22CC8D;">k</span>]<span style="color:red;">*</span><span style="color:#3CBDD0;">a.data</span>[<span style="color:#22CC8D;">k</span>][<span style="color:#5a64aa;">j</span>])<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#22CC8D;">tem; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">operator</span>&nbsp;<span style="color:red;">+</span>(<span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:#3CBDD0;">Sarray</span><span style="color:red;">&</span><span style="color:#5a64aa;">a</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">tem</span>(<span style="color:#5a64aa;">a.len,0</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#5a64aa;">len;i</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#22CC8D;">len;j</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">tem.data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span>(<span style="color:#22CC8D;">data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">+</span><span style="color:#3CBDD0;">a.data</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>])<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#22CC8D;">tem; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            }<span style="color:#5a64aa;">; </span><br>
            <br>
            <span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">qpow</span>(<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">a,ll</span>&nbsp;<span style="color:#22CC8D;">b</span>){<span style="color:grey;">//会更改a，不能按引用传递</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#5a64aa;">tem</span>(<span style="color:#22CC8D;">a.len,1</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">while</span>(<span style="color:#22CC8D;">b</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">b</span><span style="color:red;">&</span><span style="color:#5a64aa;">1</span>)<span style="color:#5a64aa;">tem</span><span style="color:red;">=</span><span style="color:#5a64aa;">a</span><span style="color:red;">*</span><span style="color:#22CC8D;">tem; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">a</span><span style="color:red;">=</span><span style="color:#5a64aa;">a</span><span style="color:red;">*</span><span style="color:#22CC8D;">a; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">b</span>&gt;&gt;<span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#22CC8D;">tem; </span><br>
            }<br>
            <br>
            <span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">qpow</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">a,ll</span>&nbsp;<span style="color:#22CC8D;">b</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">ret</span><span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">while</span>(<span style="color:#22CC8D;">b</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">b</span><span style="color:red;">&</span><span style="color:#5a64aa;">1</span>)&nbsp;<span style="color:#3CBDD0;">ret</span><span style="color:red;">=</span><span style="color:#3CBDD0;">ret</span><span style="color:red;">*</span><span style="color:#5a64aa;">a</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">a</span><span style="color:red;">=</span><span style="color:#5a64aa;">a</span><span style="color:red;">*</span><span style="color:#5a64aa;">a</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">b</span>&gt;&gt;<span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#5a64aa;">ret; </span><br>
            }<br>
            <br>
            <br>
            <span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">oria</span>[<span style="color:#3CBDD0;">3</span>][<span style="color:#3CBDD0;">3</span>]<span style="color:red;">=</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">0,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">0,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">1,0,0 </span><br>
            }<span style="color:#5a64aa;">; </span><br>
            <br>
            <span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">orib</span>[<span style="color:#3CBDD0;">3</span>][<span style="color:#3CBDD0;">3</span>]<span style="color:red;">=</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">0,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">1,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">0,0,0 </span><br>
            }<span style="color:#5a64aa;">; </span><br>
            <br>
            <span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">oric</span>[<span style="color:#3CBDD0;">3</span>][<span style="color:#3CBDD0;">3</span>]<span style="color:red;">=</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">1,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">0,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">0,0,0 </span><br>
            }<span style="color:#5a64aa;">; </span><br>
            <br>
            <span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">transs</span>[<span style="color:#3CBDD0;">3</span>][<span style="color:#3CBDD0;">3</span>]<span style="color:red;">=</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">1,1,1, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">1,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">0,1,0 </span><br>
            }<span style="color:#5a64aa;">; </span><br>
            <br>
            <span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">get</span>(<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">n,ll</span>&nbsp;<span style="color:#5a64aa;">beg</span>[<span style="color:#3CBDD0;">3</span>][<span style="color:#3CBDD0;">3</span>]){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">Sarray</span>&nbsp;<span style="color:#22CC8D;">orn</span>(<span style="color:#22CC8D;">3,1</span>)<span style="color:#5a64aa;">,trans</span>(<span style="color:#22CC8D;">3,1</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">memcpy</span>(<span style="color:#3CBDD0;">orn.data,beg,sizeof</span>(<span style="color:#5a64aa;">orn.data</span>))<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">memcpy</span>(<span style="color:#22CC8D;">trans.data,transs,sizeof</span>(<span style="color:#22CC8D;">trans.data</span>))<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">n</span><span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#5a64aa;">1</span>)&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#5a64aa;">beg</span>[<span style="color:#22CC8D;">2</span>][<span style="color:#3CBDD0;">0</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">n</span><span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#22CC8D;">2</span>)&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#5a64aa;">beg</span>[<span style="color:#5a64aa;">1</span>][<span style="color:#3CBDD0;">0</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;(<span style="color:#5a64aa;">qpow</span>(<span style="color:#5a64aa;">trans,n</span><span style="color:red;">-</span><span style="color:#3CBDD0;">3</span>)<span style="color:red;">*</span><span style="color:#22CC8D;">orn</span>)<span style="color:#3CBDD0;">.data</span>[<span style="color:#3CBDD0;">0</span>][<span style="color:#3CBDD0;">0</span>]<span style="color:#5a64aa;">; </span><br>
            }<br>
            <br>
            <span style="color:black;">int</span>&nbsp;&nbsp;<span style="color:#22CC8D;">main</span>(){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">n,f1,f2,f3,c; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">cin</span>&gt;&gt;<span style="color:#22CC8D;">n</span>&gt;&gt;<span style="color:#5a64aa;">f1</span>&gt;&gt;<span style="color:#22CC8D;">f2</span>&gt;&gt;<span style="color:#3CBDD0;">f3</span>&gt;&gt;<span style="color:#5a64aa;">c; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">g1</span><span style="color:red;">=</span><span style="color:#5a64aa;">f1</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">g2</span><span style="color:red;">=</span><span style="color:#22CC8D;">f2</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">g3</span><span style="color:red;">=</span><span style="color:#3CBDD0;">f3</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">A</span><span style="color:red;">=</span><span style="color:#5a64aa;">get</span>(<span style="color:#22CC8D;">n,oria</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">B</span><span style="color:red;">=</span><span style="color:#5a64aa;">get</span>(<span style="color:#3CBDD0;">n,orib</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">C</span><span style="color:red;">=</span><span style="color:#5a64aa;">get</span>(<span style="color:#5a64aa;">n,oric</span>)<span style="color:#5a64aa;">; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#5a64aa;">gn</span><span style="color:red;">=</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#3CBDD0;">g1,A</span>)<span style="color:red;">*</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#22CC8D;">g2,B</span>)<span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#5a64aa;">g3,C</span>)<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">t</span><span style="color:red;">=</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#3CBDD0;">c,n</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">cout</span>&lt;&lt;<span style="color:#5a64aa;">gn</span><span style="color:red;">*</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#22CC8D;">t,mod</span><span style="color:red;">-</span><span style="color:#22CC8D;">2</span>)<span style="color:red;">%</span><span style="color:#22CC8D;">mod</span>&lt;&lt;<span style="color:#22CC8D;">endl; </span><br>
            <br>
            }<br>
            <br>
    </div>
    <div type="text/javadiv" src="/ACM/js/code_end.js"></div>

    <div type="text/javadiv" src="/ACM/js/solve_begin.js"></div>
    <div>
            法2：<br>
                令g(x)=f(x)*c^x<br>
                则g(x)=g(x-1)g(x-2)g(x-3)<br>
                可以肯定出g(x)=g(1)^a*g(2)^b*g(3)*c<br>
                于是a,b,c都是x的函数<br>
                且a(x)=a(x-1)+a(x-2)+a(x-3) bc同理<br>
    </div>
    <div type="text/javadiv" src="/ACM/js/solve_end.js"></div>

    <div type="text/javadiv" src="/ACM/js/code_begin.js"></div>
    <div>
            <span style="color:#5a64aa;">#include</span>&lt;<span style="color:#3CBDD0;">bits</span><span style="color:red;">/</span><span style="color:#3CBDD0;">stdc</span><span style="color:red;">+</span><span style="color:red;">+</span><span style="color:#5a64aa;">.h</span>&gt;<br>
            <span style="color:#5a64aa;">using</span>&nbsp;<span style="color:#22CC8D;">namespace</span>&nbsp;<span style="color:#5a64aa;">std; </span><br>
            <br>
            <span style="color:black;">typedef</span>&nbsp;<span style="color:black;">long</span>&nbsp;<span style="color:black;">long</span>&nbsp;<span style="color:#5a64aa;">ll; </span><br>
            <span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">LEN</span><span style="color:red;">=</span><span style="color:#5a64aa;">3; </span><br>
            <br>
            <span style="color:#3CBDD0;">void</span>&nbsp;<span style="color:#22CC8D;">sarray_cpy</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">a</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#22CC8D;">b</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#22CC8D;">n</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">n;i</span><span style="color:red;">+</span><span style="color:red;">+</span>){<span style="color:grey;">// a/b可以为同一个数组</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#5a64aa;">n;j</span><span style="color:red;">+</span><span style="color:red;">+</span>)&nbsp;<span style="color:#22CC8D;">b</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span><span style="color:#5a64aa;">a</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            }<br>
            <br>
            <span style="color:#3CBDD0;">void</span>&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">a</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#22CC8D;">b</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#3CBDD0;">ret</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#3CBDD0;">n,int</span>&nbsp;<span style="color:#22CC8D;">mod</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">static</span>&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">c</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#22CC8D;">;</span><span style="color:grey;">// a/b/ret可以为同一个数组</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">n;i</span><span style="color:red;">+</span><span style="color:red;">+</span>)&nbsp;{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#5a64aa;">n;j</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">c</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span><span style="color:#5a64aa;">0; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">k</span><span style="color:red;">=</span><span style="color:#3CBDD0;">0;k</span>&lt;<span style="color:#22CC8D;">n;k</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">c</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span>(<span style="color:#3CBDD0;">c</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">+</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#5a64aa;">a</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#22CC8D;">k</span>]<span style="color:red;">*</span><span style="color:#22CC8D;">b</span>[<span style="color:#22CC8D;">k</span>][<span style="color:#5a64aa;">j</span>])<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">sarray_cpy</span>(<span style="color:#5a64aa;">c,ret,n</span>)<span style="color:#5a64aa;">; </span><br>
            }<br>
            <br>
            <span style="color:#3CBDD0;">void</span>&nbsp;<span style="color:#22CC8D;">sarray_qpow</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">aa</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#22CC8D;">,ll</span>&nbsp;<span style="color:#3CBDD0;">b,int</span>&nbsp;<span style="color:#3CBDD0;">ret</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#3CBDD0;">n,int</span>&nbsp;<span style="color:#22CC8D;">mod</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">static</span>&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">a</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#22CC8D;">;</span><span style="color:grey;">// aa ret可以为同一个数组</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">sarray_cpy</span>(<span style="color:#3CBDD0;">aa,a,n</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">n;i</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#5a64aa;">n;j</span><span style="color:red;">+</span><span style="color:red;">+</span>)&nbsp;<span style="color:#3CBDD0;">ret</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span><span style="color:#5a64aa;">0; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">ret</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#3CBDD0;">i</span>]<span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">while</span>(<span style="color:#22CC8D;">b</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">b</span><span style="color:red;">&</span><span style="color:#5a64aa;">1</span>)&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:#3CBDD0;">ret,a,ret,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:#22CC8D;">a,a,a,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">b</span>&gt;&gt;<span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            }<br>
            <br>
            <span style="color:#3CBDD0;">void</span>&nbsp;<span style="color:#3CBDD0;">sarray_add</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">a</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#22CC8D;">b</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#3CBDD0;">c</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#3CBDD0;">n,int</span>&nbsp;<span style="color:#22CC8D;">mod</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">n;i</span><span style="color:red;">+</span><span style="color:red;">+</span>){<span style="color:grey;">// a,b,c可以为同一个数组</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">j</span><span style="color:red;">=</span><span style="color:#22CC8D;">0;j</span>&lt;<span style="color:#5a64aa;">n;j</span><span style="color:red;">+</span><span style="color:red;">+</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">c</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">=</span>(<span style="color:#5a64aa;">a</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>]<span style="color:red;">+</span><span style="color:#22CC8D;">b</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#5a64aa;">j</span>])<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            }<br>
            <br>
            <span style="color:grey;">// a^0 a^1 a^2 a^3 ... a^b</span><br>
            <span style="color:#3CBDD0;">void</span>&nbsp;<span style="color:#5a64aa;">sarray_sum</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">a</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#22CC8D;">,ll</span>&nbsp;<span style="color:#3CBDD0;">b,int</span>&nbsp;<span style="color:#3CBDD0;">ret</span>[][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,int</span>&nbsp;<span style="color:#3CBDD0;">n,int</span>&nbsp;<span style="color:#22CC8D;">mod</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">static</span>&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">tmp</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">b</span><span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#3CBDD0;">0</span>)&nbsp;<span style="color:#22CC8D;">sarray_qpow</span>(<span style="color:#3CBDD0;">a,b,ret,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">else</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#22CC8D;">mid</span><span style="color:red;">=</span>(<span style="color:#22CC8D;">b</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)&gt;&gt;<span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">sarray_sum</span>(<span style="color:#3CBDD0;">a,mid,ret,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">sarray_qpow</span>(<span style="color:#5a64aa;">a,mid</span><span style="color:red;">+</span><span style="color:#3CBDD0;">1,tmp,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">n;i</span><span style="color:red;">+</span><span style="color:red;">+</span>)&nbsp;<span style="color:#22CC8D;">tmp</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#3CBDD0;">i</span>]<span style="color:red;">=</span>(<span style="color:#22CC8D;">tmp</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#3CBDD0;">i</span>]<span style="color:red;">+</span><span style="color:#5a64aa;">1</span>)<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:#22CC8D;">ret,tmp,ret,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>((<span style="color:#22CC8D;">b</span><span style="color:red;">&</span><span style="color:#5a64aa;">1</span>)<span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#3CBDD0;">0</span>)&nbsp;{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:#3CBDD0;">ret,a,ret,n,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">n;i</span><span style="color:red;">+</span><span style="color:red;">+</span>)&nbsp;<span style="color:#3CBDD0;">ret</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#3CBDD0;">i</span>]<span style="color:red;">=</span>(<span style="color:#3CBDD0;">ret</span>[<span style="color:#3CBDD0;">i</span>][<span style="color:#3CBDD0;">i</span>]<span style="color:red;">+</span><span style="color:#5a64aa;">1</span>)<span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            }<br>
            <br>
            <span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">qpow</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">a,int</span>&nbsp;<span style="color:#3CBDD0;">b,int</span>&nbsp;<span style="color:#22CC8D;">mod</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">ret</span><span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">while</span>(<span style="color:#22CC8D;">b</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">b</span><span style="color:red;">&</span><span style="color:#5a64aa;">1</span>)<span style="color:#3CBDD0;">ret</span><span style="color:red;">=</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#3CBDD0;">ret</span><span style="color:red;">*</span><span style="color:#5a64aa;">a</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">a</span><span style="color:red;">=</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#5a64aa;">a</span><span style="color:red;">*</span><span style="color:#5a64aa;">a</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">b</span>&gt;&gt;<span style="color:red;">=</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#5a64aa;">ret; </span><br>
            }<br>
            <br>
            <span style="color:grey;">// a^x === b   x=lg(a,b)</span><br>
            <span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">bsgs_lg</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">a,int</span>&nbsp;<span style="color:#3CBDD0;">b,int</span>&nbsp;<span style="color:#22CC8D;">mod</span>){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">map</span>&lt;<span style="color:#3CBDD0;">int,int</span>&gt;<span style="color:#5a64aa;">mp; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">sqr</span><span style="color:red;">=</span><span style="color:#3CBDD0;">sqrt</span>(<span style="color:#22CC8D;">mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:red;">+</span><span style="color:#22CC8D;">1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#3CBDD0;">sqr;i</span><span style="color:red;">+</span><span style="color:red;">+</span>)&nbsp;<span style="color:#3CBDD0;">mp</span>[<span style="color:#5a64aa;">qpow</span>(<span style="color:#22CC8D;">a,i,mod</span>)]<span style="color:red;">=</span><span style="color:#22CC8D;">i;</span>&nbsp;<span style="color:grey;">// baby step</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">for</span>(<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">=</span><span style="color:#5a64aa;">0;i</span>&lt;<span style="color:#22CC8D;">mod</span><span style="color:red;">-</span><span style="color:#22CC8D;">1;i</span><span style="color:red;">+</span><span style="color:red;">=</span><span style="color:#22CC8D;">sqr</span>){&nbsp;<span style="color:grey;">// giant step</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">tp</span><span style="color:red;">=</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#22CC8D;">b</span><span style="color:red;">*</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#5a64aa;">a,mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span><span style="color:red;">-</span><span style="color:#3CBDD0;">i,mod</span>)<span style="color:red;">%</span><span style="color:#3CBDD0;">mod;</span>&nbsp;<span style="color:grey;">// a^(-i)</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#3CBDD0;">mp.find</span>(<span style="color:#22CC8D;">tp</span>)<span style="color:red;">!</span><span style="color:red;">=</span><span style="color:#5a64aa;">mp.end</span>())&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:#3CBDD0;">i</span><span style="color:red;">+</span><span style="color:#3CBDD0;">mp</span>[<span style="color:#22CC8D;">tp</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">return</span>&nbsp;<span style="color:red;">-</span><span style="color:#5a64aa;">1;</span><span style="color:grey;">// error</span><br>
            }<br>
            <br>
            <span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">main</span>(){<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">const</span>&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">mod</span><span style="color:red;">=</span><span style="color:#22CC8D;">1e9</span><span style="color:red;">+</span><span style="color:#22CC8D;">7; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">ll</span>&nbsp;<span style="color:#3CBDD0;">n; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">f1,f2,f3,c; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">cin</span>&gt;&gt;<span style="color:#22CC8D;">n</span>&gt;&gt;<span style="color:#5a64aa;">f1</span>&gt;&gt;<span style="color:#22CC8D;">f2</span>&gt;&gt;<span style="color:#3CBDD0;">f3</span>&gt;&gt;<span style="color:#5a64aa;">c; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">g1</span><span style="color:red;">=</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#5a64aa;">f1</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">g2</span><span style="color:red;">=</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#22CC8D;">f2</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">g3</span><span style="color:red;">=</span><span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#3CBDD0;">f3</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span><span style="color:red;">*</span><span style="color:#3CBDD0;">c</span><span style="color:red;">%</span><span style="color:#3CBDD0;">mod; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">g1</span><span style="color:red;">=</span><span style="color:#5a64aa;">bsgs_lg</span>(<span style="color:#5a64aa;">5,g1,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">g2</span><span style="color:red;">=</span><span style="color:#5a64aa;">bsgs_lg</span>(<span style="color:#22CC8D;">5,g2,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">g3</span><span style="color:red;">=</span><span style="color:#5a64aa;">bsgs_lg</span>(<span style="color:#3CBDD0;">5,g3,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:grey;">// cout<<g1<<endl<<g2<<endl<<g3<<endl;</span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">orn</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:red;">=</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">g3,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">g2,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">g1,0,0 </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<span style="color:#5a64aa;">; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">trans</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:red;">=</span>{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">1,1,1, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">1,0,0, </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">0,1,0 </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<span style="color:#5a64aa;">; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#3CBDD0;">ans</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">,t; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">n</span><span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#5a64aa;">1</span>)&nbsp;<span style="color:#22CC8D;">t</span><span style="color:red;">=</span><span style="color:#5a64aa;">g1; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">else</span>&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">n</span><span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#22CC8D;">2</span>)&nbsp;<span style="color:#22CC8D;">t</span><span style="color:red;">=</span><span style="color:#22CC8D;">g2; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">else</span>&nbsp;<span style="color:#3CBDD0;">if</span>(<span style="color:#22CC8D;">n</span><span style="color:red;">=</span><span style="color:red;">=</span><span style="color:#3CBDD0;">3</span>)&nbsp;<span style="color:#22CC8D;">t</span><span style="color:red;">=</span><span style="color:#3CBDD0;">g3; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">else</span>&nbsp;{<br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">ans1</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">ans2</span>[<span style="color:#5a64aa;">LEN</span>][<span style="color:#5a64aa;">LEN</span>]<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">sarray_sum</span>(<span style="color:#5a64aa;">trans,n</span><span style="color:red;">-</span><span style="color:#5a64aa;">3,ans1,3,mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:#3CBDD0;">ans1,orn,ans1,3,mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#5a64aa;">sarray_sum</span>(<span style="color:#5a64aa;">trans,n</span><span style="color:red;">-</span><span style="color:#3CBDD0;">4,ans2,3,mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3CBDD0;">sarray_mul</span>(<span style="color:#22CC8D;">ans2,orn,ans2,3,mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">t</span><span style="color:red;">=</span>(<span style="color:#5a64aa;">ans1</span>[<span style="color:#3CBDD0;">0</span>][<span style="color:#3CBDD0;">0</span>]<span style="color:red;">-</span><span style="color:#22CC8D;">ans2</span>[<span style="color:#3CBDD0;">0</span>][<span style="color:#3CBDD0;">0</span>]<span style="color:red;">+</span><span style="color:#22CC8D;">mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:red;">%</span>(<span style="color:#22CC8D;">mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:#5a64aa;">; </span><br>
            <br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:grey;">// for(int i=0;i<3;i++)for(int j=0;j<3;j++)ans[i][j]=(ans1[i][j]-ans2[i][j]+mod)%mod;</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:grey;">// sarray_mul(ans,orn,ans,3,mod-1);</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:grey;">// t=ans[0][0];</span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#5a64aa;">gn</span><span style="color:red;">=</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#5a64aa;">5,t,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:black;">int</span>&nbsp;<span style="color:#22CC8D;">inv</span><span style="color:red;">=</span><span style="color:#5a64aa;">qpow</span>(<span style="color:#3CBDD0;">c,mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span><span style="color:red;">-</span><span style="color:#22CC8D;">n</span><span style="color:red;">%</span>(<span style="color:#22CC8D;">mod</span><span style="color:red;">-</span><span style="color:#5a64aa;">1</span>)<span style="color:#3CBDD0;">,mod</span>)<span style="color:#5a64aa;">; </span><br>
            &nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#22CC8D;">cout</span>&lt;&lt;<span style="color:#5a64aa;">1ll</span><span style="color:red;">*</span><span style="color:#5a64aa;">gn</span><span style="color:red;">*</span><span style="color:#22CC8D;">inv</span><span style="color:red;">%</span><span style="color:#22CC8D;">mod</span>&lt;&lt;<span style="color:#22CC8D;">endl; </span><br>
            <br>
            }<br>
            <br>
            <br>
    </div>
    <div type="text/javadiv" src="/ACM/js/code_end.js"></div>

            <span>此文标签</span><br>
                <a href="bsgs.html"> bsgs </a>                <a href="矩阵快速幂.html"> 矩阵快速幂 </a><br>


</div>
<div type="text/javadiv" src="/ACM/js/web_end.js"></div></div></article></div></main><footer><div class="paginator"><a href="/apollo/bzoj2655.html" class="prev">PREV</a><a href="/apollo/cf_566_div2_F.html" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2023 <a href="http://fightinggg.github.io/apollo">fightinggg</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>