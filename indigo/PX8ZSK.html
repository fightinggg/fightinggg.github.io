<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>hdu6584 | Believe it | 相信不屈不挠的努力,相信战胜死亡的年轻</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="">
    <meta name="description" content="nexthexonextbutterflyvolantisyearnyiliashokaindigoapollolandscapecactusmateryicarusfluidmaterial  ###nameMeteor ###descirptionhough time passes, there is always someone we will never forget.“The proba">
<meta property="og:type" content="article">
<meta property="og:title" content="hdu6584">
<meta property="og:url" content="http://fightinggg.github.io/indigo/PX8ZSK.html">
<meta property="og:site_name" content="Believe it">
<meta property="og:description" content="nexthexonextbutterflyvolantisyearnyiliashokaindigoapollolandscapecactusmateryicarusfluidmaterial  ###nameMeteor ###descirptionhough time passes, there is always someone we will never forget.“The proba">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-09-03T09:02:44.000Z">
<meta property="article:modified_time" content="2019-09-03T09:02:44.000Z">
<meta property="article:author" content="fightinggg">
<meta name="twitter:card" content="summary">
    
        <link rel="alternate" type="application/atom+xml" title="Believe it" href="/indigo/atom.xml">
    
    <link rel="shortcut icon" href="/indigo/favicon.ico">
    <link rel="stylesheet" href="/indigo/css/style.css?v=1.7.2">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/indigo/img/brand.jpg)">
      <div class="brand">
        <a href="/indigo/" class="avatar waves-effect waves-circle waves-light">
          <img src="/indigo/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">fightinggg</h5>
          <a href="mailto:634206017@qq.com" title="634206017@qq.com" class="mail">634206017@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/indigo/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/indigo/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/indigo/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/indigo/categories"  >
                <i class="icon icon-lg icon-th-list"></i>
                Categories
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/yscoder" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://www.weibo.com/ysweb" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/indigo/custom"  >
                <i class="icon icon-lg icon-link"></i>
                测试
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">hdu6584</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">hdu6584</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-09-03T09:02:44.000Z" itemprop="datePublished" class="page-time">
  2019-09-03
</time>


	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/indigo/categories/ACM/">ACM</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/indigo/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/">刷题实战</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/indigo/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/hdu/">hdu</a></li></ul></li></ul></li></ul>

            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    

<article id="post-ACM/刷题实战/hdu/hdu6584/index"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">hdu6584</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-09-03 17:02:44" datetime="2019-09-03T09:02:44.000Z"  itemprop="datePublished">2019-09-03</time>

            
	<ul class="article-category-list"><li class="article-category-list-item"><a class="article-category-list-link" href="/indigo/categories/ACM/">ACM</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/indigo/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/">刷题实战</a><ul class="article-category-list-child"><li class="article-category-list-item"><a class="article-category-list-link" href="/indigo/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/hdu/">hdu</a></li></ul></li></ul></li></ul>



            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <div><a href="/next/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">next</a><a href="/hexonext/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">hexonext</a><a href="/butterfly/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">butterfly</a><a href="/volantis/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">volantis</a><a href="/yearn/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yearn</a><a href="/yilia/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yilia</a><a href="/shoka/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">shoka</a><a href="/indigo/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">indigo</a><a href="/apollo/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">apollo</a><a href="/landscape/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">landscape</a><a href="/cactus/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">cactus</a><a href="/matery/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">matery</a><a href="/icarus/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">icarus</a><a href="/fluid/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">fluid</a><a href="/material/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">material</a><div style="clear: both;"></div></div>

<p>###name<br>Meteor</p>
<p>###descirption<br>hough time passes, there is always someone we will never forget.<br>“The probability of being hit by a meteor is one in a billion, but it is much more miraculous, to meet you in my life.” said Tom to Jerry with affection.<br>“One in a billion? I may not agree with you.” answered Jerry proudly, “Let’s do the math.”<br>…<br>Thinking of the days they have happily spent together, Tom can’t help bursting into tears. Though Jerry has been gone for a long time, Tom still misses him every day. He remembers it was a sunny afternoon when Jerry and him were lying in the yard, working on the probability of a man being hit by a meteor.<br>Unlike Jerry, he was always slow. Jerry got the answer soon, but Tom was stuck as usual. In the end, Tom lost patience and asked Jerry to tell him the answer.<br>“I can’t be so straightforward,” snickered Jerry, “the only thing I will tell you is that the answer is $\frac{p}{q}$, where p,q≤n,gcd(p,q)&#x3D;1.”<br>“Is it $\frac{1}{n}$?”<br>“Is it $\frac{1}{n-1}$?”<br>…<br>If answered “No” , he would try the minimum larger number that satisfies the requirement.<br>Tom only remembered n given by Jerry, and k, the times that he tried, but forgot what matters the most: Jerry’s answer. Now, he wants you to help him find it.</p>
<!---more-->

<p>###input<br>The first line contains an integer $T(T≤10^2)$, the number of test cases.<br>The next T lines, each line contains two number$s, n,k(2≤n≤10^6)$, indicating a query.<br>The answer is guaranteed to be in (0,1].</p>
<p>###output<br>T lines, each line contains a fraction in term of p&#x2F;q ,where gcd(p,q)&#x3D;1.</p>
<p>###sample input<br>5<br>4 6<br>5 1<br>9 9<br>3 4<br>7 11</p>
<p>###sample output<br>1&#x2F;1<br>1&#x2F;5<br>1&#x2F;3<br>1&#x2F;1<br>3&#x2F;5</p>
<p>###toturial<br>$$<br>\begin{aligned}<br>&amp;答案肯定是找到一个分子分母小于n的分数\frac{p}{q}他满足下面的特征\<br>&amp;(\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1][\frac{i}{j} \leq \frac{p}{q}]) &#x3D; k\<br>&amp;我们对左式化简\<br>&amp;&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1][i \leq \frac{p}{q}j]\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^ne(gcd(i,j))\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n(u*1)(gcd(i,j))\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|gcd(i,j)}u(d)*1(d)\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|gcd(i,j)}u(d)\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|i,d|j}u(d)\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n[d|i,d|j]\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{xd&#x3D;1}^{\lfloor \frac{p}{q}(yd)\rfloor}\sum_{yd&#x3D;1}^n[d|(xd),d|(yd)]\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{x&#x3D;1}^{\lfloor\frac{\lfloor \frac{p}{q}(yd)\rfloor}{d}\rfloor}\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}1\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\lfloor\frac{\lfloor \frac{p}{q}(yd)\rfloor}{d}\rfloor\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}{\lfloor \frac{p}{q}y\rfloor}\<br>\end{aligned}<br>$$<br>这里是可以求出答案的,对d分块，右边的部分采用类欧几里得算法<br>我们一直往下二分，直到区间足够小，最后用 Stern-Brocot Tree 或 法雷序列找出答案</p>
<p>###code</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****  * 超级积性函数线性筛 *  ****/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll maxn=<span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line">ll no_pri[maxn]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>&#125;,pri[maxn],low[maxn];</span><br><span class="line">ll PHI[maxn],DDD[maxn],XDX[maxn],MUU[maxn],SIG[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f_ini</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!no_pri[i]) low[i]=pri[++pri[<span class="number">0</span>]]=i;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">1</span>;pri[j]*i&lt;maxn;j++)&#123;</span><br><span class="line">            no_pri[pri[j]*i]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) &#123;</span><br><span class="line">                low[pri[j]*i]=low[i]*pri[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> low[pri[j]*i]=pri[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DDD[<span class="number">1</span>]=PHI[<span class="number">1</span>]=MUU[<span class="number">1</span>]=SIG[<span class="number">1</span>]=<span class="number">1</span>;<span class="comment">// 改这里</span></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=pri[<span class="number">0</span>];i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll mul=pri[i],ct=<span class="number">1</span>;mul&lt;maxn;mul*=pri[i],ct++)&#123;</span><br><span class="line">            DDD[mul]=ct+<span class="number">1</span>;<span class="comment">// 改这里</span></span><br><span class="line">            SIG[mul]=SIG[mul/pri[i]]+mul;<span class="comment">// 改这里</span></span><br><span class="line">            MUU[mul]=ct==<span class="number">1</span>?<span class="number">-1</span>:<span class="number">0</span>;<span class="comment">// 改这里</span></span><br><span class="line">            PHI[mul]=mul/pri[i]*(pri[i]<span class="number">-1</span>);<span class="comment">// 改这里</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">1</span>;pri[j]*i&lt;maxn;j++)&#123;</span><br><span class="line">            ll x=low[i*pri[j]], y=i*pri[j]/x;</span><br><span class="line">            DDD[x*y]=DDD[x]*DDD[y];</span><br><span class="line">            MUU[x*y]=MUU[x]*MUU[y];</span><br><span class="line">            PHI[x*y]=PHI[x]*PHI[y];</span><br><span class="line">            SIG[x*y]=SIG[x]*SIG[y];</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;maxn;i++) &#123;</span><br><span class="line">        DDD[i]+=DDD[i<span class="number">-1</span>];</span><br><span class="line">        MUU[i]+=MUU[i<span class="number">-1</span>];</span><br><span class="line">        PHI[i]+=PHI[i<span class="number">-1</span>];</span><br><span class="line">        SIG[i]+=SIG[i<span class="number">-1</span>];</span><br><span class="line">        XDX[i]=(DDD[i]-DDD[i<span class="number">-1</span>])*i+XDX[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">frac</span>&#123;</span><br><span class="line">    ll x,y;</span><br><span class="line">    <span class="built_in">frac</span>(ll x_=<span class="number">0</span>,ll y_=<span class="number">1</span>)&#123;</span><br><span class="line">        ll gcd=__gcd(x_,y_);</span><br><span class="line">        x=x_/gcd;</span><br><span class="line">        y=y_/gcd;</span><br><span class="line">    &#125;</span><br><span class="line">    frac <span class="keyword">operator</span> +(<span class="type">const</span> frac&amp;rhs)&#123;</span><br><span class="line">        ll lcm=y/__gcd(y,rhs.y)*rhs.y;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">frac</span>(x*(lcm/y)+rhs.x*(lcm/rhs.y),lcm);</span><br><span class="line">    &#125;</span><br><span class="line">    frac <span class="keyword">operator</span> /(ll k)&#123;</span><br><span class="line">        ll gcd=__gcd(k,x);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">frac</span>(x/gcd,y*(k/gcd));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;=(<span class="type">const</span> frac&amp;rhs)&#123;</span><br><span class="line">        ll lcm=y/__gcd(y,rhs.y)*rhs.y;</span><br><span class="line">        <span class="keyword">return</span> x*(lcm/y)&lt;=rhs.x*(lcm/rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a&gt;=0 b&gt;=0 c&gt;0 n&gt;=0         -&gt; O(lg(a,c))</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calfgh</span><span class="params">(ll a,ll b,ll c,ll n,ll&amp;f,ll&amp;g,ll&amp;h)</span></span>&#123;</span><br><span class="line">    ll A=a/c,B=b/c,s0=n+<span class="number">1</span>,s1=n*(n+<span class="number">1</span>)/<span class="number">2</span>,s2=n*(n+<span class="number">1</span>)*(<span class="number">2</span>*n+<span class="number">1</span>)/<span class="number">6</span>;</span><br><span class="line">    f=s1*A+s0*B;</span><br><span class="line">    g=s2*A+s1*B;</span><br><span class="line">    h=s2*A*A+s0*B*B+<span class="number">2</span>*s1*A*B<span class="number">-2</span>*B*f<span class="number">-2</span>*A*g;<span class="comment">// 先减掉</span></span><br><span class="line">    a%=c,b%=c;</span><br><span class="line">    ll m=(a*n+b)/c;</span><br><span class="line">    <span class="keyword">if</span>(m!=<span class="number">0</span>) &#123;</span><br><span class="line">        ll ff,gg,hh; <span class="built_in">calfgh</span>(c,c-b<span class="number">-1</span>,a,m<span class="number">-1</span>,ff,gg,hh);</span><br><span class="line">        f+=n*m-ff;</span><br><span class="line">        g+=(n*m*(n+<span class="number">1</span>)-hh-ff)/<span class="number">2</span>;</span><br><span class="line">        h+=n*m*m<span class="number">-2</span>*gg-ff;</span><br><span class="line">    &#125;</span><br><span class="line">    h+=<span class="number">2</span>*B*f+<span class="number">2</span>*A*g;<span class="comment">//再加上</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">count</span><span class="params">(frac k,<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    ll ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,ed;i&lt;=n;i=ed+<span class="number">1</span>)&#123;</span><br><span class="line">        ed=n/(n/i);</span><br><span class="line">        ll a[<span class="number">3</span>]; <span class="built_in">calfgh</span>(k.x,<span class="number">0</span>,k.y,n/i,a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>]);</span><br><span class="line">        ret+=<span class="number">1ll</span>*(MUU[ed]-MUU[i<span class="number">-1</span>])*a[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">f_ini</span>();</span><br><span class="line">    ll t,n,k;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;k);</span><br><span class="line">        <span class="function">frac <span class="title">l</span><span class="params">(<span class="number">0</span>,<span class="number">1</span>)</span>,<span class="title">r</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span></span>;<span class="comment">// [l,r]</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> ijk=<span class="number">0</span>;ijk&lt;<span class="number">40</span>;ijk++)&#123;</span><br><span class="line">            frac mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">            ll ct=<span class="built_in">count</span>(mid,n);<span class="comment">//[0,mid]</span></span><br><span class="line">            <span class="keyword">if</span>(ct&gt;=k)r=mid;</span><br><span class="line">            <span class="keyword">else</span> l=mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//[l,r]</span></span><br><span class="line">        <span class="function">frac <span class="title">L</span><span class="params">(<span class="number">0</span>,<span class="number">1</span>)</span>,<span class="title">R</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="function">frac <span class="title">mid</span><span class="params">(L.x+R.x,L.y+R.y)</span></span>;</span><br><span class="line">            <span class="keyword">if</span>(mid.x&lt;=n&amp;&amp;mid.y&lt;=n&amp;&amp;l&lt;=mid&amp;&amp;mid&lt;=r)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld/%lld\n&quot;</span>,mid.x,mid.y);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(l&lt;=mid))&#123;</span><br><span class="line">                L=mid;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(mid&lt;=r))&#123;</span><br><span class="line">                R=mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2019-09-03T09:02:44.000Z" itemprop="dateUpdated">2019-09-03 17:02:44</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="<%- url_for(page.path).replace(/index\.html$/, '') %>" target="_blank" rel="external"><%- page.permalink.replace(/index\.html$/, '') %></a>
        
    </div>
    
    <footer>
        <a href="http://fightinggg.github.io/indigo">
            <img src="/indigo/img/avatar.jpg" alt="fightinggg">
            fightinggg
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://fightinggg.github.io/indigo/PX8ZSK.html&title=《hdu6584》 — Believe it&pic=http://fightinggg.github.io/indigo/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://fightinggg.github.io/indigo/PX8ZSK.html&title=《hdu6584》 — Believe it&source=O ever youthful, O ever weeping" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://fightinggg.github.io/indigo/PX8ZSK.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《hdu6584》 — Believe it&url=http://fightinggg.github.io/indigo/PX8ZSK.html&via=http://fightinggg.github.io/indigo" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://fightinggg.github.io/indigo/PX8ZSK.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/indigo/PXACE6.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">hdu6586</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/indigo/PX8XZD.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">hdu6583</h4>
      </a>
    </div>
  
</nav>



    




















</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/indigo/img/wechat.jpg" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/indigo/img/wechat.jpg" data-alipay="/indigo/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/indigo/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p><span>fightinggg &copy; 2015 - 2023</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://fightinggg.github.io/indigo/PX8ZSK.html&title=《hdu6584》 — Believe it&pic=http://fightinggg.github.io/indigo/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://fightinggg.github.io/indigo/PX8ZSK.html&title=《hdu6584》 — Believe it&source=O ever youthful, O ever weeping" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://fightinggg.github.io/indigo/PX8ZSK.html" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《hdu6584》 — Believe it&url=http://fightinggg.github.io/indigo/PX8ZSK.html&via=http://fightinggg.github.io/indigo" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://fightinggg.github.io/indigo/PX8ZSK.html" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACJElEQVR42u3awY7qMAwFUP7/p5ntSG+Ae53ypCYnK0Sh6enCsmM/HvF6/lr/fvPq+5V7Pr6xMDAwbst4vl3vf/P7artLcjV5NgwMjHMYrzZOPie/XN/rw30wMDAwyiCYJ5H5vhgYGBjt7fJwnKShSfjGwMDAmJWpyQFZC/56LY6BgXFDRn7q/v8/f6W/gYGBcSvGs1x5wpc3KZ/LCwMDY2/GVQ3IPExfFXAxMDBOY8zK1PVBsVmA/kDFwMDYlJEnf7NwvNK2LJ4KAwNjU8b6qMTsDrP71HkrBgbGdow2aWvP55Pith0m+yPgYmBgbMf4RvC9KnEchmAMDIztGO1Bf3s817Y2h2UtBgbGAYz11mP70PlxW/RUGBgYWzNmM6J5wpfgc8xs4AMDA2NXxsrBfb7ZymgFBgbGmYxZApeHv/yIv31lGBgYezPycrQtUFtYUri+vIqBgXEMIz/2mjUm2xo6L48xMDD2ZuQtyVkC1zYvZ/fEwMA4gbESZIu5s3aEovwXBgbGCYy2ZM1L0Dzqty80escYGBjbMdrN8qP/y+Y+1juiGBgYt2KsNANmKWD7Ei9LCjEwMG7LuCooz5oESyXrDIOBgXFbxkqQXWlztv/6kLxiYGAcwJg1L5M2ZBuCh0knBgYGxiiZe59ctqXvh10wMDAwyg1WJtSSodXLUkMMDIxbMfIxi7Y9mTcS8jQRAwPjNEZbOratglmhO3sqDAyM7Rg/Qp1qmDwe05sAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/indigo/', SHARE: true, REWARD: true };


</script>

<script src="/indigo/js/main.js?v=1.7.2"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/indigo/js/search.js?v=1.7.2" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '死鬼去哪里了！';
            clearTimeout(titleTime);
        } else {
            document.title = '(つェ⊂)咦!又好了!';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
