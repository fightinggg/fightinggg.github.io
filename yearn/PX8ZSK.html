<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="keywords" content="hexo,个人博客,blog" />
  <meta name="description" content="某某的个人博客" />
  <meta http-equiv="x-dns-prefetch-control" content="on">
  <link rel="dns-prefetch" href="https://busuanzi.ibruce.info">
  <link rel="dns-prefetch" href="https://at.alicdn.com">
  
  <link rel="dns-prefetch" href="https://widget.daovoice.io">
  <link rel="dns-prefetch" href="https://widget-static-cdn.daovoice.io">
  <link rel="dns-prefetch" href="https://im.daovoice.io">
  
  
  <link rel="dns-prefetch" href="https://hm.baidu.com/">
  
  
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://api.github.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  
  <link rel="stylesheet" type="text/css" href="/yearn/./style/main.css">
	<link rel="shortcut icon" href="/favicon.ico" title="Favicon">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
	<title>hdu6584</title>
  
  <script>var _hmt=_hmt||[];(function(){var hm=document.createElement("script");hm.src="https://hm.baidu.com/hm.js?awwssw1snsnsnn1ndndnndnd99j";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm,s);})();
  </script>
  
  
    <script>(function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/123456.js","daovoice");daovoice('init',{app_id: "123456"});daovoice('update');
  </script>
  
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
  <canvas id="pattern-placeholder" height="230"></canvas>
<div class="navbar-header">
  <a class="blog-title" href="/yearn/">Believe it</a>
  <a class="face-img" href="/yearn/">
    <img src="https://tva3.sinaimg.cn/crop.0.0.200.200.180/005Kc3C1jw8f2uep0hhkvj305k05k3yk.jpg">
  </a>
</div>
<main>
  <div class="article-title">
    
  
  <h1 class="title">
    hdu6584
  </h1>
  


    <ul class="article-info">
      <li>
        发布
        <time datetime="2019-09-03T09:02:44.000Z" itemprop="datePublished">2019-09-03</time>
      </li>
      <li>
        
    更新 <time datetime="2019-09-03T09:02:44.000Z" itemprop="dateUpdated">2019-09-03</time>

      </li>
      <li id="busuanzi_container_page_pv">
        阅读 <span id="busuanzi_value_page_pv"></span>
      </li>
    </ul>
  </div>
  <div class="container">
    <div class="article">
      <div class="content">
        
        <div><a href="/next/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">next</a><a href="/hexonext/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">hexonext</a><a href="/butterfly/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">butterfly</a><a href="/volantis/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">volantis</a><a href="/yearn/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yearn</a><a href="/yilia/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yilia</a><a href="/shoka/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">shoka</a><a href="/indigo/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">indigo</a><a href="/apollo/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">apollo</a><a href="/landscape/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">landscape</a><a href="/cactus/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">cactus</a><a href="/matery/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">matery</a><a href="/icarus/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">icarus</a><a href="/fluid/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">fluid</a><a href="/material/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">material</a><div style="clear: both;"></div></div>

<p>###name<br>Meteor</p>
<p>###descirption<br>hough time passes, there is always someone we will never forget.<br>“The probability of being hit by a meteor is one in a billion, but it is much more miraculous, to meet you in my life.” said Tom to Jerry with affection.<br>“One in a billion? I may not agree with you.” answered Jerry proudly, “Let’s do the math.”<br>…<br>Thinking of the days they have happily spent together, Tom can’t help bursting into tears. Though Jerry has been gone for a long time, Tom still misses him every day. He remembers it was a sunny afternoon when Jerry and him were lying in the yard, working on the probability of a man being hit by a meteor.<br>Unlike Jerry, he was always slow. Jerry got the answer soon, but Tom was stuck as usual. In the end, Tom lost patience and asked Jerry to tell him the answer.<br>“I can’t be so straightforward,” snickered Jerry, “the only thing I will tell you is that the answer is $\frac{p}{q}$, where p,q≤n,gcd(p,q)&#x3D;1.”<br>“Is it $\frac{1}{n}$?”<br>“Is it $\frac{1}{n-1}$?”<br>…<br>If answered “No” , he would try the minimum larger number that satisfies the requirement.<br>Tom only remembered n given by Jerry, and k, the times that he tried, but forgot what matters the most: Jerry’s answer. Now, he wants you to help him find it.</p>
<!---more-->

<p>###input<br>The first line contains an integer $T(T≤10^2)$, the number of test cases.<br>The next T lines, each line contains two number$s, n,k(2≤n≤10^6)$, indicating a query.<br>The answer is guaranteed to be in (0,1].</p>
<p>###output<br>T lines, each line contains a fraction in term of p&#x2F;q ,where gcd(p,q)&#x3D;1.</p>
<p>###sample input<br>5<br>4 6<br>5 1<br>9 9<br>3 4<br>7 11</p>
<p>###sample output<br>1&#x2F;1<br>1&#x2F;5<br>1&#x2F;3<br>1&#x2F;1<br>3&#x2F;5</p>
<p>###toturial<br>$$<br>\begin{aligned}<br>&amp;答案肯定是找到一个分子分母小于n的分数\frac{p}{q}他满足下面的特征\<br>&amp;(\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1][\frac{i}{j} \leq \frac{p}{q}]) &#x3D; k\<br>&amp;我们对左式化简\<br>&amp;&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1][i \leq \frac{p}{q}j]\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^ne(gcd(i,j))\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n(u*1)(gcd(i,j))\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|gcd(i,j)}u(d)*1(d)\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|gcd(i,j)}u(d)\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|i,d|j}u(d)\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n[d|i,d|j]\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{xd&#x3D;1}^{\lfloor \frac{p}{q}(yd)\rfloor}\sum_{yd&#x3D;1}^n[d|(xd),d|(yd)]\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{x&#x3D;1}^{\lfloor\frac{\lfloor \frac{p}{q}(yd)\rfloor}{d}\rfloor}\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}1\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\lfloor\frac{\lfloor \frac{p}{q}(yd)\rfloor}{d}\rfloor\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}{\lfloor \frac{p}{q}y\rfloor}\<br>\end{aligned}<br>$$<br>这里是可以求出答案的,对d分块，右边的部分采用类欧几里得算法<br>我们一直往下二分，直到区间足够小，最后用 Stern-Brocot Tree 或 法雷序列找出答案</p>
<p>###code</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****  * 超级积性函数线性筛 *  ****/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll maxn=<span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line">ll no_pri[maxn]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>&#125;,pri[maxn],low[maxn];</span><br><span class="line">ll PHI[maxn],DDD[maxn],XDX[maxn],MUU[maxn],SIG[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f_ini</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!no_pri[i]) low[i]=pri[++pri[<span class="number">0</span>]]=i;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">1</span>;pri[j]*i&lt;maxn;j++)&#123;</span><br><span class="line">            no_pri[pri[j]*i]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) &#123;</span><br><span class="line">                low[pri[j]*i]=low[i]*pri[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> low[pri[j]*i]=pri[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DDD[<span class="number">1</span>]=PHI[<span class="number">1</span>]=MUU[<span class="number">1</span>]=SIG[<span class="number">1</span>]=<span class="number">1</span>;<span class="comment">// 改这里</span></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=pri[<span class="number">0</span>];i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll mul=pri[i],ct=<span class="number">1</span>;mul&lt;maxn;mul*=pri[i],ct++)&#123;</span><br><span class="line">            DDD[mul]=ct+<span class="number">1</span>;<span class="comment">// 改这里</span></span><br><span class="line">            SIG[mul]=SIG[mul/pri[i]]+mul;<span class="comment">// 改这里</span></span><br><span class="line">            MUU[mul]=ct==<span class="number">1</span>?<span class="number">-1</span>:<span class="number">0</span>;<span class="comment">// 改这里</span></span><br><span class="line">            PHI[mul]=mul/pri[i]*(pri[i]<span class="number">-1</span>);<span class="comment">// 改这里</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">1</span>;pri[j]*i&lt;maxn;j++)&#123;</span><br><span class="line">            ll x=low[i*pri[j]], y=i*pri[j]/x;</span><br><span class="line">            DDD[x*y]=DDD[x]*DDD[y];</span><br><span class="line">            MUU[x*y]=MUU[x]*MUU[y];</span><br><span class="line">            PHI[x*y]=PHI[x]*PHI[y];</span><br><span class="line">            SIG[x*y]=SIG[x]*SIG[y];</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;maxn;i++) &#123;</span><br><span class="line">        DDD[i]+=DDD[i<span class="number">-1</span>];</span><br><span class="line">        MUU[i]+=MUU[i<span class="number">-1</span>];</span><br><span class="line">        PHI[i]+=PHI[i<span class="number">-1</span>];</span><br><span class="line">        SIG[i]+=SIG[i<span class="number">-1</span>];</span><br><span class="line">        XDX[i]=(DDD[i]-DDD[i<span class="number">-1</span>])*i+XDX[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">frac</span>&#123;</span><br><span class="line">    ll x,y;</span><br><span class="line">    <span class="built_in">frac</span>(ll x_=<span class="number">0</span>,ll y_=<span class="number">1</span>)&#123;</span><br><span class="line">        ll gcd=__gcd(x_,y_);</span><br><span class="line">        x=x_/gcd;</span><br><span class="line">        y=y_/gcd;</span><br><span class="line">    &#125;</span><br><span class="line">    frac <span class="keyword">operator</span> +(<span class="type">const</span> frac&amp;rhs)&#123;</span><br><span class="line">        ll lcm=y/__gcd(y,rhs.y)*rhs.y;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">frac</span>(x*(lcm/y)+rhs.x*(lcm/rhs.y),lcm);</span><br><span class="line">    &#125;</span><br><span class="line">    frac <span class="keyword">operator</span> /(ll k)&#123;</span><br><span class="line">        ll gcd=__gcd(k,x);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">frac</span>(x/gcd,y*(k/gcd));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;=(<span class="type">const</span> frac&amp;rhs)&#123;</span><br><span class="line">        ll lcm=y/__gcd(y,rhs.y)*rhs.y;</span><br><span class="line">        <span class="keyword">return</span> x*(lcm/y)&lt;=rhs.x*(lcm/rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a&gt;=0 b&gt;=0 c&gt;0 n&gt;=0         -&gt; O(lg(a,c))</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calfgh</span><span class="params">(ll a,ll b,ll c,ll n,ll&amp;f,ll&amp;g,ll&amp;h)</span></span>&#123;</span><br><span class="line">    ll A=a/c,B=b/c,s0=n+<span class="number">1</span>,s1=n*(n+<span class="number">1</span>)/<span class="number">2</span>,s2=n*(n+<span class="number">1</span>)*(<span class="number">2</span>*n+<span class="number">1</span>)/<span class="number">6</span>;</span><br><span class="line">    f=s1*A+s0*B;</span><br><span class="line">    g=s2*A+s1*B;</span><br><span class="line">    h=s2*A*A+s0*B*B+<span class="number">2</span>*s1*A*B<span class="number">-2</span>*B*f<span class="number">-2</span>*A*g;<span class="comment">// 先减掉</span></span><br><span class="line">    a%=c,b%=c;</span><br><span class="line">    ll m=(a*n+b)/c;</span><br><span class="line">    <span class="keyword">if</span>(m!=<span class="number">0</span>) &#123;</span><br><span class="line">        ll ff,gg,hh; <span class="built_in">calfgh</span>(c,c-b<span class="number">-1</span>,a,m<span class="number">-1</span>,ff,gg,hh);</span><br><span class="line">        f+=n*m-ff;</span><br><span class="line">        g+=(n*m*(n+<span class="number">1</span>)-hh-ff)/<span class="number">2</span>;</span><br><span class="line">        h+=n*m*m<span class="number">-2</span>*gg-ff;</span><br><span class="line">    &#125;</span><br><span class="line">    h+=<span class="number">2</span>*B*f+<span class="number">2</span>*A*g;<span class="comment">//再加上</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">count</span><span class="params">(frac k,<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    ll ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,ed;i&lt;=n;i=ed+<span class="number">1</span>)&#123;</span><br><span class="line">        ed=n/(n/i);</span><br><span class="line">        ll a[<span class="number">3</span>]; <span class="built_in">calfgh</span>(k.x,<span class="number">0</span>,k.y,n/i,a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>]);</span><br><span class="line">        ret+=<span class="number">1ll</span>*(MUU[ed]-MUU[i<span class="number">-1</span>])*a[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">f_ini</span>();</span><br><span class="line">    ll t,n,k;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;k);</span><br><span class="line">        <span class="function">frac <span class="title">l</span><span class="params">(<span class="number">0</span>,<span class="number">1</span>)</span>,<span class="title">r</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span></span>;<span class="comment">// [l,r]</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> ijk=<span class="number">0</span>;ijk&lt;<span class="number">40</span>;ijk++)&#123;</span><br><span class="line">            frac mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">            ll ct=<span class="built_in">count</span>(mid,n);<span class="comment">//[0,mid]</span></span><br><span class="line">            <span class="keyword">if</span>(ct&gt;=k)r=mid;</span><br><span class="line">            <span class="keyword">else</span> l=mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//[l,r]</span></span><br><span class="line">        <span class="function">frac <span class="title">L</span><span class="params">(<span class="number">0</span>,<span class="number">1</span>)</span>,<span class="title">R</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="function">frac <span class="title">mid</span><span class="params">(L.x+R.x,L.y+R.y)</span></span>;</span><br><span class="line">            <span class="keyword">if</span>(mid.x&lt;=n&amp;&amp;mid.y&lt;=n&amp;&amp;l&lt;=mid&amp;&amp;mid&lt;=r)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld/%lld\n&quot;</span>,mid.x,mid.y);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(l&lt;=mid))&#123;</span><br><span class="line">                L=mid;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(mid&lt;=r))&#123;</span><br><span class="line">                R=mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      </div>
        <div class="support-author">
          <p>感谢您的阅读。 🙏
          <a href="https://888.com/index.html" target="_blank">关于转载请看这里</a>
            <!--<a class="btn-pay"  href="#pay-modal">¥ 打赏支持</a>-->
          </p>
        </div>
        <!--
            <div class="like ">
              <div class="like-button">
                <a id="like-note" href="">
                  <i class="icon-heart"></i>喜欢
                </a>
              </div>
              <span id="likes-count">256</span>
            </div>
        -->
        <div class="otherLink">
          <div class="previous">
          </div>
          <div class="next">
          </div>
        </div>
        <div class="comments" id="comments">
          
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script type="text/javascript">
  const gitalk = new Gitalk({
    clientID: '8888a8888',
    clientSecret: '8888886666666',
    repo: 'xxxx.github.io',
    owner: 'admin',
    admin: ['admin'],
    id: location.pathname,      // Ensure uniqueness and length less than 50
    distractionFreeMode: false
  })

  gitalk.render('comments');
</script>


        </div>
      </div>
    </div>
   </div>
</main>
<div class="footer">
  <div class="info">
    <p>
    <a target="_blank" rel="noopener" href="https://hexo.io"> Hexo </a> 强力驱动 |
      <a target="_blank" rel="noopener" href="https://github.com/Youthink/hexo-themes-yearn"> Yearn </a>
      主题
    </p>
    <p>&copy;2013-2018 某某的博客 京ICP备xxxxxx号</p>
  </div>
</div>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script>//console
  var consoleConfig = '\n欢迎访问 https://hufangyun.com ，围观小猿大圣的博客(づ｡◕‿‿◕｡)づ！\n,\n本博客使用 %cHexo%c 搭建，博客主题为小猿大圣开发的 %chexo-themes-yearn%c ~~~ 🎉🎉🎉 \n\n源码 https://github.com/Youthink/hexo-themes-yearn \n\n如果喜欢可以 star 支持一下 ❤️~\n,\n扫描下面的二维码，在手机上查看博客！\n,https://static.hufangyun.com/blog-url-qrcode-180-180.png,\n 想知道这个效果如何实现的？博客内搜索 console 彩蛋 🚀 ！\n'.split(',');
  var canConsole = true;
  var consoleInfo = (function(consoleConfig) {
  if (!canConsole || !consoleConfig || consoleConfig.length < 1) {
    return;
  }
  var consoleColor = '#6190e8';
  var _console;
  var backgroundTextStyle = 'padding: 1px 5px;color: #fff;background: ' + consoleColor + ';'
  var textStyle = 'color: ' + consoleColor + ';';

  consoleConfig.map(o => {
    var num = (o.match(/%c/g) || []).length;
    if(/^http(s)?:\/\//.test(o)) {
      console.log('%c     ', 'background: url(' + o + ') no-repeat left center;font-size: 180px;');
      return;
    }
    if (num > 0) {
      var logArguments = [];
      for (var i = 0; i < num; i++) {
        if (i % 2 === 0) {
          logArguments.push(backgroundTextStyle);
        } else {
          logArguments.push(textStyle);
        }
      }
      (_console = console).log.apply(_console, ['%c' + o, textStyle].concat(logArguments));
      return;
    }
    console.log('%c' + o, textStyle);
  });
}(consoleConfig));</script><script type="text/javascript" src="/yearn/./js/main.js"></script>

  <script src="//at.alicdn.com/t/font_159214_mvtxvg9me9.js"></script>
</body>
</html>
