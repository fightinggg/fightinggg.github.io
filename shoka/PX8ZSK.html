



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/shoka/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/shoka/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="Believe it" href="http://fightinggg.github.io/shoka/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="Believe it" href="http://fightinggg.github.io/shoka/atom.xml" />
<link rel="alternate" type="application/json" title="Believe it" href="http://fightinggg.github.io/shoka/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/shoka/css/app.css?v=0.2.5">

  

<link rel="canonical" href="http://fightinggg.github.io/shoka/PX8ZSK.html">



  <title>
hdu6584 - hdu - 刷题实战 - ACM |
Yume Shoka = Believe it = 相信不屈不挠的努力,相信战胜死亡的年轻</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">hdu6584
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2019-09-03 17:02:44">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2019-09-03T17:02:44+08:00">2019-09-03</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/shoka/" rel="start">Yume Shoka</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipeubcbajj20zk0m8h1h.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicis081o9j20zk0m8dmr.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicivghyooj20zk0m8dir.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclimtf7dj20zk0m8qav.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclflwv2aj20zk0m84qp.jpg"></li>
          <li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipey0a334j20zk0m8qpt.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/shoka/">首页</a></span><i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/shoka/categories/ACM/" itemprop="item" rel="index" title="分类于 ACM"><span itemprop="name">ACM</span></a>
<meta itemprop="position" content="1" /></span>
<i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/shoka/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/" itemprop="item" rel="index" title="分类于 刷题实战"><span itemprop="name">刷题实战</span></a>
<meta itemprop="position" content="2" /></span>
<i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/shoka/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/hdu/" itemprop="item" rel="index" title="分类于 hdu"><span itemprop="name">hdu</span></a>
<meta itemprop="position" content="3" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="http://fightinggg.github.io/shoka/PX8ZSK.html">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/shoka/images/avatar.jpg">
    <meta itemprop="name" content="fightinggg">
    <meta itemprop="description" content="相信不屈不挠的努力,相信战胜死亡的年轻, O ever youthful, O ever weeping">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Believe it">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <div><a href="/next/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">next</a><a href="/hexonext/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">hexonext</a><a href="/butterfly/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">butterfly</a><a href="/volantis/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">volantis</a><a href="/yearn/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yearn</a><a href="/yilia/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">yilia</a><a href="/shoka/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">shoka</a><a href="/indigo/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">indigo</a><a href="/apollo/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">apollo</a><a href="/landscape/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">landscape</a><a href="/cactus/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">cactus</a><a href="/matery/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">matery</a><a href="/icarus/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">icarus</a><a href="/fluid/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">fluid</a><a href="/material/PX8ZSK.html" style="border-bottom: 0px;border-bottom: 0px;
            background: #4FC921;
            color: white;
            border-radius: 5px;
            padding: 2px 6px 2px 6px;
            margin: 2px 6px 2px 6px;
            text-decoration: none;
            float: left;
            ">material</a><div style="clear: both;"></div></div>

<p>###name<br>Meteor</p>
<p>###descirption<br>hough time passes, there is always someone we will never forget.<br>“The probability of being hit by a meteor is one in a billion, but it is much more miraculous, to meet you in my life.” said Tom to Jerry with affection.<br>“One in a billion? I may not agree with you.” answered Jerry proudly, “Let’s do the math.”<br>…<br>Thinking of the days they have happily spent together, Tom can’t help bursting into tears. Though Jerry has been gone for a long time, Tom still misses him every day. He remembers it was a sunny afternoon when Jerry and him were lying in the yard, working on the probability of a man being hit by a meteor.<br>Unlike Jerry, he was always slow. Jerry got the answer soon, but Tom was stuck as usual. In the end, Tom lost patience and asked Jerry to tell him the answer.<br>“I can’t be so straightforward,” snickered Jerry, “the only thing I will tell you is that the answer is $\frac{p}{q}$, where p,q≤n,gcd(p,q)&#x3D;1.”<br>“Is it $\frac{1}{n}$?”<br>“Is it $\frac{1}{n-1}$?”<br>…<br>If answered “No” , he would try the minimum larger number that satisfies the requirement.<br>Tom only remembered n given by Jerry, and k, the times that he tried, but forgot what matters the most: Jerry’s answer. Now, he wants you to help him find it.</p>
<!---more-->

<p>###input<br>The first line contains an integer $T(T≤10^2)$, the number of test cases.<br>The next T lines, each line contains two number$s, n,k(2≤n≤10^6)$, indicating a query.<br>The answer is guaranteed to be in (0,1].</p>
<p>###output<br>T lines, each line contains a fraction in term of p&#x2F;q ,where gcd(p,q)&#x3D;1.</p>
<p>###sample input<br>5<br>4 6<br>5 1<br>9 9<br>3 4<br>7 11</p>
<p>###sample output<br>1&#x2F;1<br>1&#x2F;5<br>1&#x2F;3<br>1&#x2F;1<br>3&#x2F;5</p>
<p>###toturial<br>$$<br>\begin{aligned}<br>&amp;答案肯定是找到一个分子分母小于n的分数\frac{p}{q}他满足下面的特征\<br>&amp;(\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1][\frac{i}{j} \leq \frac{p}{q}]) &#x3D; k\<br>&amp;我们对左式化简\<br>&amp;&#x3D;\sum_{i&#x3D;1}^n\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1][i \leq \frac{p}{q}j]\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n[gcd(i,j)&#x3D;1]\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^ne(gcd(i,j))\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n(u*1)(gcd(i,j))\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|gcd(i,j)}u(d)*1(d)\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|gcd(i,j)}u(d)\<br>&amp;&#x3D;\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n\sum_{d|i,d|j}u(d)\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{i&#x3D;1}^{\lfloor \frac{p}{q}j\rfloor}\sum_{j&#x3D;1}^n[d|i,d|j]\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{xd&#x3D;1}^{\lfloor \frac{p}{q}(yd)\rfloor}\sum_{yd&#x3D;1}^n[d|(xd),d|(yd)]\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{x&#x3D;1}^{\lfloor\frac{\lfloor \frac{p}{q}(yd)\rfloor}{d}\rfloor}\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}1\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}\lfloor\frac{\lfloor \frac{p}{q}(yd)\rfloor}{d}\rfloor\<br>&amp;&#x3D;\sum_{d&#x3D;1}^{n}u(d)\sum_{y&#x3D;1}^{\lfloor\frac{n}{d}\rfloor}{\lfloor \frac{p}{q}y\rfloor}\<br>\end{aligned}<br>$$<br>这里是可以求出答案的,对d分块，右边的部分采用类欧几里得算法<br>我们一直往下二分，直到区间足够小，最后用 Stern-Brocot Tree 或 法雷序列找出答案</p>
<p>###code</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****  * 超级积性函数线性筛 *  ****/</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">const</span> ll maxn=<span class="number">2e6</span>+<span class="number">10</span>;</span><br><span class="line">ll no_pri[maxn]=&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>&#125;,pri[maxn],low[maxn];</span><br><span class="line">ll PHI[maxn],DDD[maxn],XDX[maxn],MUU[maxn],SIG[maxn];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">f_ini</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!no_pri[i]) low[i]=pri[++pri[<span class="number">0</span>]]=i;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">1</span>;pri[j]*i&lt;maxn;j++)&#123;</span><br><span class="line">            no_pri[pri[j]*i]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) &#123;</span><br><span class="line">                low[pri[j]*i]=low[i]*pri[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> low[pri[j]*i]=pri[j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DDD[<span class="number">1</span>]=PHI[<span class="number">1</span>]=MUU[<span class="number">1</span>]=SIG[<span class="number">1</span>]=<span class="number">1</span>;<span class="comment">// 改这里</span></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=pri[<span class="number">0</span>];i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll mul=pri[i],ct=<span class="number">1</span>;mul&lt;maxn;mul*=pri[i],ct++)&#123;</span><br><span class="line">            DDD[mul]=ct+<span class="number">1</span>;<span class="comment">// 改这里</span></span><br><span class="line">            SIG[mul]=SIG[mul/pri[i]]+mul;<span class="comment">// 改这里</span></span><br><span class="line">            MUU[mul]=ct==<span class="number">1</span>?<span class="number">-1</span>:<span class="number">0</span>;<span class="comment">// 改这里</span></span><br><span class="line">            PHI[mul]=mul/pri[i]*(pri[i]<span class="number">-1</span>);<span class="comment">// 改这里</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">2</span>;i&lt;maxn;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(ll j=<span class="number">1</span>;pri[j]*i&lt;maxn;j++)&#123;</span><br><span class="line">            ll x=low[i*pri[j]], y=i*pri[j]/x;</span><br><span class="line">            DDD[x*y]=DDD[x]*DDD[y];</span><br><span class="line">            MUU[x*y]=MUU[x]*MUU[y];</span><br><span class="line">            PHI[x*y]=PHI[x]*PHI[y];</span><br><span class="line">            SIG[x*y]=SIG[x]*SIG[y];</span><br><span class="line">            <span class="keyword">if</span>(i%pri[j]==<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;maxn;i++) &#123;</span><br><span class="line">        DDD[i]+=DDD[i<span class="number">-1</span>];</span><br><span class="line">        MUU[i]+=MUU[i<span class="number">-1</span>];</span><br><span class="line">        PHI[i]+=PHI[i<span class="number">-1</span>];</span><br><span class="line">        SIG[i]+=SIG[i<span class="number">-1</span>];</span><br><span class="line">        XDX[i]=(DDD[i]-DDD[i<span class="number">-1</span>])*i+XDX[i<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">frac</span>&#123;</span><br><span class="line">    ll x,y;</span><br><span class="line">    <span class="built_in">frac</span>(ll x_=<span class="number">0</span>,ll y_=<span class="number">1</span>)&#123;</span><br><span class="line">        ll gcd=__gcd(x_,y_);</span><br><span class="line">        x=x_/gcd;</span><br><span class="line">        y=y_/gcd;</span><br><span class="line">    &#125;</span><br><span class="line">    frac <span class="keyword">operator</span> +(<span class="type">const</span> frac&amp;rhs)&#123;</span><br><span class="line">        ll lcm=y/__gcd(y,rhs.y)*rhs.y;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">frac</span>(x*(lcm/y)+rhs.x*(lcm/rhs.y),lcm);</span><br><span class="line">    &#125;</span><br><span class="line">    frac <span class="keyword">operator</span> /(ll k)&#123;</span><br><span class="line">        ll gcd=__gcd(k,x);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">frac</span>(x/gcd,y*(k/gcd));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span> &lt;=(<span class="type">const</span> frac&amp;rhs)&#123;</span><br><span class="line">        ll lcm=y/__gcd(y,rhs.y)*rhs.y;</span><br><span class="line">        <span class="keyword">return</span> x*(lcm/y)&lt;=rhs.x*(lcm/rhs.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// a&gt;=0 b&gt;=0 c&gt;0 n&gt;=0         -&gt; O(lg(a,c))</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">calfgh</span><span class="params">(ll a,ll b,ll c,ll n,ll&amp;f,ll&amp;g,ll&amp;h)</span></span>&#123;</span><br><span class="line">    ll A=a/c,B=b/c,s0=n+<span class="number">1</span>,s1=n*(n+<span class="number">1</span>)/<span class="number">2</span>,s2=n*(n+<span class="number">1</span>)*(<span class="number">2</span>*n+<span class="number">1</span>)/<span class="number">6</span>;</span><br><span class="line">    f=s1*A+s0*B;</span><br><span class="line">    g=s2*A+s1*B;</span><br><span class="line">    h=s2*A*A+s0*B*B+<span class="number">2</span>*s1*A*B<span class="number">-2</span>*B*f<span class="number">-2</span>*A*g;<span class="comment">// 先减掉</span></span><br><span class="line">    a%=c,b%=c;</span><br><span class="line">    ll m=(a*n+b)/c;</span><br><span class="line">    <span class="keyword">if</span>(m!=<span class="number">0</span>) &#123;</span><br><span class="line">        ll ff,gg,hh; <span class="built_in">calfgh</span>(c,c-b<span class="number">-1</span>,a,m<span class="number">-1</span>,ff,gg,hh);</span><br><span class="line">        f+=n*m-ff;</span><br><span class="line">        g+=(n*m*(n+<span class="number">1</span>)-hh-ff)/<span class="number">2</span>;</span><br><span class="line">        h+=n*m*m<span class="number">-2</span>*gg-ff;</span><br><span class="line">    &#125;</span><br><span class="line">    h+=<span class="number">2</span>*B*f+<span class="number">2</span>*A*g;<span class="comment">//再加上</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">count</span><span class="params">(frac k,<span class="type">int</span> n)</span></span>&#123;</span><br><span class="line">    ll ret=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,ed;i&lt;=n;i=ed+<span class="number">1</span>)&#123;</span><br><span class="line">        ed=n/(n/i);</span><br><span class="line">        ll a[<span class="number">3</span>]; <span class="built_in">calfgh</span>(k.x,<span class="number">0</span>,k.y,n/i,a[<span class="number">0</span>],a[<span class="number">1</span>],a[<span class="number">2</span>]);</span><br><span class="line">        ret+=<span class="number">1ll</span>*(MUU[ed]-MUU[i<span class="number">-1</span>])*a[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">f_ini</span>();</span><br><span class="line">    ll t,n,k;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%lld&quot;</span>,&amp;t);</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%lld%lld&quot;</span>,&amp;n,&amp;k);</span><br><span class="line">        <span class="function">frac <span class="title">l</span><span class="params">(<span class="number">0</span>,<span class="number">1</span>)</span>,<span class="title">r</span><span class="params">(<span class="number">1</span>,<span class="number">1</span>)</span></span>;<span class="comment">// [l,r]</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> ijk=<span class="number">0</span>;ijk&lt;<span class="number">40</span>;ijk++)&#123;</span><br><span class="line">            frac mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">            ll ct=<span class="built_in">count</span>(mid,n);<span class="comment">//[0,mid]</span></span><br><span class="line">            <span class="keyword">if</span>(ct&gt;=k)r=mid;</span><br><span class="line">            <span class="keyword">else</span> l=mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//[l,r]</span></span><br><span class="line">        <span class="function">frac <span class="title">L</span><span class="params">(<span class="number">0</span>,<span class="number">1</span>)</span>,<span class="title">R</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="literal">true</span>)&#123;</span><br><span class="line">            <span class="function">frac <span class="title">mid</span><span class="params">(L.x+R.x,L.y+R.y)</span></span>;</span><br><span class="line">            <span class="keyword">if</span>(mid.x&lt;=n&amp;&amp;mid.y&lt;=n&amp;&amp;l&lt;=mid&amp;&amp;mid&lt;=r)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%lld/%lld\n&quot;</span>,mid.x,mid.y);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(l&lt;=mid))&#123;</span><br><span class="line">                L=mid;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(!(mid&lt;=r))&#123;</span><br><span class="line">                R=mid;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
  </div>

   <footer>

    <div class="meta">
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/shoka/images/wechatpay.png" alt="fightinggg 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/shoka/images/alipay.png" alt="fightinggg 支付宝">
        <p>支付宝</p>
      </div>
      
      <div>
        <img data-src="/shoka/images/paypal.png" alt="fightinggg 贝宝">
        <p>贝宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>fightinggg <i class="ic i-at"><em>@</em></i>Believe it
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="http://fightinggg.github.io/shoka/PX8ZSK.html" title="hdu6584">http://fightinggg.github.io/shoka/PX8ZSK.html</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/shoka/PX8XZD.html" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclimtf7dj20zk0m8qav.jpg" title="hdu6583">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> hdu</span>
  <h3>hdu6583</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/shoka/PXACE6.html" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giciuja1j1j20zk0m8kjl.jpg" title="hdu6586">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> hdu</span>
  <h3>hdu6586</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/shoka/PLM7NB.html" rel="bookmark" title="hdu5745">hdu5745</a></li><li><a href="/shoka/PVSXM7.html" rel="bookmark" title="hdu6625">hdu6625</a></li><li><a href="/shoka/PVVFI8.html" rel="bookmark" title="hdu6624">hdu6624</a></li><li><a href="/shoka/PVX8RV.html" rel="bookmark" title="hdu6635">hdu6635</a></li><li><a href="/shoka/PW1ZIX.html" rel="bookmark" title="hdu4578">hdu4578</a></li><li><a href="/shoka/PW4Q34.html" rel="bookmark" title="hdu6647">hdu6647</a></li><li><a href="/shoka/PW63JL.html" rel="bookmark" title="hdu5634">hdu5634</a></li><li><a href="/shoka/PW867L.html" rel="bookmark" title="hdu6667">hdu6667</a></li><li><a href="/shoka/PX3W2O.html" rel="bookmark" title="hdu6705">hdu6705</a></li><li><a href="/shoka/PX7LJD.html" rel="bookmark" title="hdu6578">hdu6578</a></li><li><a href="/shoka/PX7PJ2.html" rel="bookmark" title="hdu6579">hdu6579</a></li><li><a href="/shoka/PX8SP2.html" rel="bookmark" title="hdu6581">hdu6581</a></li><li><a href="/shoka/PX8T10.html" rel="bookmark" title="hdu6582">hdu6582</a></li><li><a href="/shoka/PX8XZD.html" rel="bookmark" title="hdu6583">hdu6583</a></li><li class="active"><a href="/shoka/PX8ZSK.html" rel="bookmark" title="hdu6584">hdu6584</a></li><li><a href="/shoka/PXACE6.html" rel="bookmark" title="hdu6586">hdu6586</a></li><li><a href="/shoka/PXAESV.html" rel="bookmark" title="hdu6588">hdu6588</a></li><li><a href="/shoka/PZLR1D.html" rel="bookmark" title="hdu6703">hdu6703</a></li><li><a href="/shoka/Q056L8.html" rel="bookmark" title="hdu6607">hdu6607</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="fightinggg"
      data-src="/shoka/images/avatar.jpg">
  <p class="name" itemprop="name">fightinggg</p>
  <div class="description" itemprop="description">O ever youthful, O ever weeping</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/shoka/archives/">
        <span class="count">464</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/shoka/categories/">
        <span class="count">76</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/shoka/tags/">
        <span class="count">16</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/shoka/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/shoka/PX8XZD.html" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/shoka/PXACE6.html" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/Language/" title="分类于 Language">Language</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Language/Java/" title="分类于 Java">Java</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Language/Java/SpringCloud/" title="分类于 SpringCloud">SpringCloud</a>
</div>

    <span><a href="/shoka/Q9N2JF.html" title="SpringCloud5">SpringCloud5</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/ACM/" title="分类于 ACM">ACM</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E8%80%81Blog%E8%BF%81%E7%A7%BB/" title="分类于 老Blog迁移">老Blog迁移</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E8%80%81Blog%E8%BF%81%E7%A7%BB/reading-problem/" title="分类于 reading_problem">reading_problem</a>
</div>

    <span><a href="/shoka/cf446A.html" title="cf446A">cf446A</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/Language/" title="分类于 Language">Language</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Language/Java/" title="分类于 Java">Java</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Language/Java/Spring/" title="分类于 Spring">Spring</a>
</div>

    <span><a href="/shoka/Q8BOOS.html" title="spring6-依赖注入">spring6-依赖注入</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/ACM/" title="分类于 ACM">ACM</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/" title="分类于 刷题实战">刷题实战</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E5%88%B7%E9%A2%98%E5%AE%9E%E6%88%98/CodeForces/" title="分类于 CodeForces">CodeForces</a>
</div>

    <span><a href="/shoka/QX56IC.html" title="Educational Codeforces Round 112 (Rated for Div. 2)">Educational Codeforces Round 112 (Rated for Div. 2)</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/Language/" title="分类于 Language">Language</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Language/Java/" title="分类于 Java">Java</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Language/Java/JVM/" title="分类于 JVM">JVM</a>
</div>

    <span><a href="/shoka/Q5KF8D.html" title="走进Java">走进Java</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/ACM/" title="分类于 ACM">ACM</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E8%80%81Blog%E8%BF%81%E7%A7%BB/" title="分类于 老Blog迁移">老Blog迁移</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E8%80%81Blog%E8%BF%81%E7%A7%BB/stencil/" title="分类于 stencil">stencil</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E8%80%81Blog%E8%BF%81%E7%A7%BB/stencil/data-struct/" title="分类于 data_struct">data_struct</a>
</div>

    <span><a href="/shoka/cdq.html" title="cdq">cdq</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/Docker/" title="分类于 Docker">Docker</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/Docker/K8s/" title="分类于 K8s">K8s</a>
</div>

    <span><a href="/shoka/QQHDS0.html" title="k8s学习">k8s学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/ACM/" title="分类于 ACM">ACM</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="分类于 学习笔记">学习笔记</a>
<i class="ic i-angle-right"></i>
<a href="/shoka/categories/ACM/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/%E6%A0%91/" title="分类于 树">树</a>
</div>

    <span><a href="/shoka/Q9K2JU.html" title="Kruskal重构树">Kruskal重构树</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/Others/" title="分类于 Others">Others</a>
</div>

    <span><a href="/shoka/QRNM0C.html" title="CICD">CICD</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/shoka/categories/Database/" title="分类于 Database">Database</a>
</div>

    <span><a href="/shoka/Q8PP3V.html" title="mysql-入门">mysql-入门</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">fightinggg @ Yume Shoka</span>
  </div>
  <div class="powered-by">
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'PX8ZSK.html',
    favicon: {
      show: "（●´3｀●）やれやれだぜ",
      hide: "(´Д｀)大変だ！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/shoka/js/app.js?v=0.2.5"></script>




</body>
</html>
